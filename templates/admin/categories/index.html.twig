{% extends 'baseadmin.html.twig' %}

{% block admin_title %}Catégories{% endblock %}

{% block admin_body %}
<div class="mt-4">

    <h1 class="mb-4">Gestion des catégories</h1>

    <div class="mb-3">
        <a href="{{ path('admin_categories_add') }}" class="btn btn-primary">
            Ajouter une catégorie
        </a>
    </div>

    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <th>Id</th>
            <th>Nom</th>
            <th>Nb formations</th>
            <th class="text-end">Actions</th>
        </tr>
        </thead>
        <tbody>
        {% for categorie in categories %}
            <tr>
                <td>{{ categorie.id }}</td>
                <td>{{ categorie.name }}</td>
                <td>{{ categorie.formations|length }}</td>

                <td class="text-end">

                    <form method="post"
                          action="{{ path('admin_categories_delete', {id: categorie.id}) }}"
                          style="display:inline-block"
                          onsubmit="return confirm('Supprimer cette catégorie ?');">

                        <input type="hidden" name="_token"
                               value="{{ csrf_token('delete' ~ categorie.id) }}">

                        <button class="btn btn-sm btn-danger"
                                {% if categorie.formations|length > 0 %}disabled{% endif %}>
                            Supprimer
                        </button>
                    </form>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4">Aucune catégorie trouvée.</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
